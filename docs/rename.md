# `filemate rename`

Renames files within a specified directory based on a sequential pattern.

This command processes files in alphanumeric sorted order and allows you to customize the renaming pattern, filter by file extension, set a starting number, and optionally move the renamed files to a different directory.

## Usage

```bash
filemate rename [OPTIONS] FOLDER
```

## Arguments

*   `FOLDER` _(required)_: The path to the directory containing the files you want to rename. This directory must exist.

## Options

*   `--pattern TEXT`:
    *   Specifies the pattern for the new filenames.
    *   Must include the placeholder `{i}` which will be replaced by the sequential index number.
    *   _Default_: `"file_{i}"`

*   `--ext TEXT`:
    *   Filters the files to be renamed based on their extension(s).
    *   Provide a comma-separated list of extensions (e.g., `.jpg,.png` or `jpg,png`). Leading dots are optional and will be added automatically.
    *   If omitted, all files in the `FOLDER` are considered for renaming.
    *   _Examples_: `jpg,png,gif`, `.txt`, `jpeg`
    *   _Default_: `None`

*   `--start INTEGER`:
    *   Sets the starting index number for the `{i}` placeholder in the pattern.
    *   Must be an integer greater than or equal to 1.
    *   _Default_: `1`

*   `--output-dir PATH`, `-o PATH`:
    *   Specifies an alternative directory where the renamed files should be saved (moved).
    *   If the directory does not exist, it will be created automatically.
    *   If omitted, files are renamed within the original `FOLDER`.
    *   _Default_: `None`

*   `--dry-run`:
    *   Performs a simulation of the renaming process without actually changing any files.
    *   Prints the intended changes to the console (e.g., `[DRY RUN] old_name.txt â†’ new_name_1.txt`).
    *   Useful for previewing the results before applying them.
    *   _Flag_: `--dry-run`

## Behavior

*   **Sorting**: Files within the `FOLDER` are processed in standard alphanumeric sort order before renaming begins.
*   **Conflict Resolution**: If a target filename generated by the pattern already exists (either in the source `FOLDER` or `output-dir`), the command will automatically increment the index `{i}` and try the next number (e.g., if `file_1.txt` exists, it will try `file_2.txt`). It will attempt this up to 10 times (`MAX_RENAME_ATTEMPTS`) for each file before skipping that file with an error message.
*   **Error Handling**:
    *   Files skipped due to persistent naming conflicts are reported.
    *   Files skipped due to `PermissionError` during the rename operation are reported.
    *   Other unexpected errors during renaming are reported, and the specific file is skipped.
*   **Output**: The command uses `rich` to display progress and the outcome of each file operation (Renamed, Dry Run, Skipped/Error) in the console.

## Examples

1.  **Basic Rename:** Rename all `.txt` files in `my_docs` starting from 1, using the default pattern `file_{i}`.
    ```bash
    filemate rename my_docs --ext .txt
    # Example result: report.txt -> file_1.txt, summary.txt -> file_2.txt
    ```

2.  **Custom Pattern and Start Index:** Rename `.jpg` images in `vacation_pics` to `Vacation_{i}.jpg`, starting the numbering from 100.
    ```bash
    filemate rename vacation_pics --pattern "Vacation_{i}" --start 100 --ext .jpg
    # Example result: IMG_001.jpg -> Vacation_100.jpg, IMG_002.jpg -> Vacation_101.jpg
    ```

3.  **Multiple Extensions and Output Directory:** Rename `.png` and `.gif` files from `source_images` into a new directory `processed_images`, using the pattern `image_{i}`.
    ```bash
    filemate rename source_images --ext png,gif --pattern "image_{i}" --output-dir processed_images
    # Result: Renamed png/gif files moved to processed_images/image_1.*, processed_images/image_2.* etc.
    # processed_images directory is created if it doesn't exist.
    ```

4.  **Dry Run:** Preview renaming all files in `downloads` folder with the pattern `download_{i}` without making changes.
    ```bash
    filemate rename downloads --pattern "download_{i}" --dry-run
    # Output will show "[DRY RUN] old_name.ext -> download_1.ext", etc.
    ```

5.  **Combining Options:** Rename `.jpeg` and `.jpg` files in `camera_roll`, starting from 50, moving them to `sorted_photos`, using pattern `Photo_{i}`.
    ```bash
    filemate rename camera_roll -o sorted_photos --ext jpeg,jpg --start 50 --pattern "Photo_{i}"
    # Result: Renamed jpeg/jpg files moved to sorted_photos/Photo_50.*, sorted_photos/Photo_51.* etc.
    ```
